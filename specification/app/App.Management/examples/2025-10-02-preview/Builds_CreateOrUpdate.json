{
  "operationId": "Builds_CreateOrUpdate",
  "parameters": {
    "api-version": "2025-10-02-preview",
    "buildEnvelope": {
      "properties": {
        "configuration": {
          "baseOs": "DebianBullseye",
          "environmentVariables": [
            {
              "name": "foo1",
              "value": "bar1"
            },
            {
              "name": "foo2",
              "value": "bar2"
            }
          ],
          "platform": "dotnetcore",
          "platformVersion": "7.0",
          "preBuildSteps": [
            {
              "description": "First pre build step.",
              "httpGet": {
                "fileName": "output.txt",
                "headers": [
                  "foo",
                  "bar"
                ],
                "url": "https://microsoft.com"
              },
              "scripts": [
                "echo 'hello'",
                "echo 'world'"
              ]
            },
            {
              "description": "Second pre build step.",
              "httpGet": {
                "fileName": "output.txt",
                "headers": [
                  "foo"
                ],
                "url": "https://microsoft.com"
              },
              "scripts": [
                "echo 'hello'",
                "echo 'again'"
              ]
            }
          ]
        },
        "destinationContainerRegistry": {
          "image": "test.azurecr.io/repo:tag",
          "server": "test.azurecr.io"
        }
      }
    },
    "buildName": "testBuild-123456789az",
    "builderName": "testBuilder",
    "resourceGroupName": "rg",
    "subscriptionId": "00000000-0000-0000-0000-000000000000"
  },
  "title": "Builds_CreateOrUpdate_WithConfig",
  "responses": {
    "200": {
      "body": {
        "name": "testBuild-123456789az",
        "type": "Microsoft.App/builders/builds",
        "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/rg/providers/Microsoft.App/builders/testBuilder/builds/testBuild-123456789az",
        "properties": {
          "buildStatus": "InProgress",
          "configuration": {
            "baseOs": "DebianBullseye",
            "environmentVariables": [
              {
                "name": "foo1",
                "value": "bar1"
              },
              {
                "name": "foo2",
                "value": "bar2"
              }
            ],
            "platform": "dotnetcore",
            "platformVersion": "7.0",
            "preBuildSteps": [
              {
                "description": "First pre build step.",
                "httpGet": {
                  "fileName": "output.txt",
                  "headers": [
                    "foo",
                    "bar"
                  ],
                  "url": "https://microsoft.com"
                },
                "scripts": [
                  "echo 'hello'",
                  "echo 'world'"
                ]
              },
              {
                "description": "Second pre build step.",
                "httpGet": {
                  "fileName": "output.txt",
                  "headers": [
                    "foo"
                  ],
                  "url": "https://microsoft.com"
                },
                "scripts": [
                  "echo 'hello'",
                  "echo 'again'"
                ]
              }
            ]
          },
          "destinationContainerRegistry": {
            "image": "test.azurecr.io/repo:tag",
            "server": "test.azurecr.io"
          },
          "logStreamEndpoint": "https://foo.azurecontainerapps.dev/logstream",
          "provisioningState": "Succeeded",
          "tokenEndpoint": "https://management.azure.com/subscriptions/{subscription-id}/resourcegroups/{rg-id}/Microsoft.App/builders/testBuilder/builds/testBuild/listAuthToken",
          "uploadEndpoint": "https://foo.azurecontainerapps.dev/upload"
        },
        "systemData": {
          "createdAt": "2022-10-11T11:05:51.4940669Z",
          "createdBy": "sample@microsoft.com",
          "createdByType": "User",
          "lastModifiedAt": "2022-10-11T11:05:51.4940669Z",
          "lastModifiedBy": "sample@microsoft.com",
          "lastModifiedByType": "User"
        }
      }
    },
    "201": {
      "body": {
        "name": "testBuild",
        "type": "Microsoft.App/build",
        "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/rg/providers/Microsoft.App/builders/testBuilder/builds/testBuild",
        "properties": {
          "buildStatus": "NotStarted",
          "configuration": {
            "baseOs": "DebianBullseye",
            "environmentVariables": [
              {
                "name": "foo1",
                "value": "bar1"
              },
              {
                "name": "foo2",
                "value": "bar2"
              }
            ],
            "platform": "dotnetcore",
            "platformVersion": "7.0",
            "preBuildSteps": [
              {
                "description": "First pre build step.",
                "httpGet": {
                  "fileName": "output.txt",
                  "headers": [
                    "foo",
                    "bar"
                  ],
                  "url": "https://microsoft.com"
                },
                "scripts": [
                  "echo 'hello'",
                  "echo 'world'"
                ]
              },
              {
                "description": "Second pre build step.",
                "httpGet": {
                  "fileName": "output.txt",
                  "headers": [
                    "foo"
                  ],
                  "url": "https://microsoft.com"
                },
                "scripts": [
                  "echo 'hello'",
                  "echo 'again'"
                ]
              }
            ]
          },
          "destinationContainerRegistry": {
            "image": "test.azurecr.io/repo:tag",
            "server": "test.azurecr.io"
          },
          "logStreamEndpoint": "https://foo.azurecontainerapps.dev/logstream",
          "provisioningState": "Creating",
          "tokenEndpoint": "https://management.azure.com/subscriptions/{subscription-id}/resourcegroups/{rg-id}/Microsoft.App/builders/testBuilder/builds/testBuild/listAuthToken",
          "uploadEndpoint": "https://foo.azurecontainerapps.dev/upload"
        },
        "systemData": {
          "createdAt": "2022-10-11T11:05:51.4940669Z",
          "createdBy": "sample@microsoft.com",
          "createdByType": "User",
          "lastModifiedAt": "2022-10-11T11:05:51.4940669Z",
          "lastModifiedBy": "sample@microsoft.com",
          "lastModifiedByType": "User"
        }
      },
      "headers": {
        "Azure-AsyncOperation": "https://management.azure.com/subscriptions/{subscription-id}/providers/Microsoft.App/locations/{location}/operationStatuses/{operationId}"
      }
    }
  }
}